<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Programa de Predicaci√≥n</title>

<!-- FUENTES -->
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&family=Poppins:wght@400;600&display=swap" rel="stylesheet">

<style>
:root{
  --bg1:#6a11cb;--bg2:#8e9eab;--bg3:#2575fc;
  --text:#111;--card:#ffffffdd;--accent:#2563eb;
}
body.dark{
  --bg1:#1e1e2f;--bg2:#2c2c3a;--bg3:#111827;
  --text:#f1f5f9;--card:#1f2937;
}
body{
  margin:0;
  font-family:"Roboto",Arial,Helvetica,sans-serif;
  color:var(--text);
  background:linear-gradient(135deg,var(--bg1),var(--bg2),var(--bg3));
  min-height:100vh;
}

/* TEXTO GRANDE (>40 a√±os + problemas visi√≥n) */
body.large-text{
  font-size:1.4em;
  font-family:"Poppins","Roboto",Arial,Helvetica,sans-serif;
  font-weight:400;
  line-height:1.6;
}

/* TEXTO PEQUE√ëO (sin problemas visi√≥n) */
body.small-text{
  font-size:0.95em;
  font-family:"Roboto",Arial,Helvetica,sans-serif;
  font-weight:300;
}

/* PANTALLA PREVIA */
#preScreen{
  position:fixed;
  inset:0;
  background:linear-gradient(135deg,#6a11cb,#2575fc);
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:9999;
}
.preCard{
  background:white;
  padding:22px;
  border-radius:16px;
  width:320px;
  box-shadow:0 10px 30px rgba(0,0,0,.3);
}
.preCard h2{margin-top:0;}
.preCard input,.preCard select,.preCard button{
  width:100%;
  padding:10px;
  margin-top:10px;
  border-radius:8px;
  border:1px solid #ccc;
  font-size:16px;
}

/* === TU DISE√ëO === */
.container{max-width:1100px;margin:auto;padding:16px;}
.topbar{display:flex;justify-content:space-between;align-items:center;}
.topbar-buttons{display:flex;gap:10px;align-items:center;}

/* Botones ‚Äî clases reutilizables */
.btn{padding:8px 14px;border:none;border-radius:8px;cursor:pointer;background:#0b5cff;color:#fff;font-weight:600;transition:background 0.18s, transform 0.08s;display:inline-flex;align-items:center;gap:8px}
.btn:hover{background:#084fd6}
.btn:active{transform:scale(0.98)}
.btn:focus-visible{outline:3px solid #ffd54f;outline-offset:3px;border-radius:6px}
.btn-secondary{background:#111827;color:#fff}
.btn-success{background:#059669;color:#fff}
.btn-warning{background:#f59e0b;color:#111}
.btn-ghost{background:#ffffff;color:inherit;border:1px solid rgba(0,0,0,0.08)}
.full-width{width:100%}

/* Ajustes menores existentes */
button{padding:8px 14px;border:none;border-radius:6px;cursor:pointer;background:#2563eb;color:white;font-weight:500;transition:background 0.3s;}
button:hover{background:#1d4ed8;}
button:active{transform:scale(0.98);}

/* SLIDER FORMATO DE LETRA */
.format-popup{
  position:fixed;
  top:80px;
  right:16px;
  background:var(--card);
  border:2px solid var(--accent);
  border-radius:12px;
  padding:16px;
  box-shadow:0 4px 12px rgba(0,0,0,.2);
  z-index:100;
  display:none;
  width:220px;
}
.format-popup.active{display:block;}
.format-label{font-weight:600;margin-bottom:12px;}
.slider{
  width:100%;
  height:6px;
  border-radius:3px;
  background:#ddd;
  outline:none;
  -webkit-appearance:none;
  appearance:none;
}
.slider::-webkit-slider-thumb{
  -webkit-appearance:none;
  appearance:none;
  width:18px;
  height:18px;
  border-radius:50%;
  background:var(--accent);
  cursor:pointer;
  box-shadow:0 2px 6px rgba(0,0,0,.2);
}
.slider::-moz-range-thumb{
  width:18px;
  height:18px;
  border-radius:50%;
  background:var(--accent);
  cursor:pointer;
  border:none;
  box-shadow:0 2px 6px rgba(0,0,0,.2);
}

/* MODAL C√ìDIGOS */
.modal{
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.5);
  z-index:1000;
  align-items:center;
  justify-content:center;
}
.modal.active{display:flex;}
.modal-content{
  background:var(--card);
  border-radius:12px;
  padding:24px;
  max-width:500px;
  max-height:80vh;
  overflow-y:auto;
  box-shadow:0 10px 30px rgba(0,0,0,.3);
}
.modal-content h2{margin-top:0;}
.codigos-grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:8px;
  margin:16px 0;
}
.codigo-item{
  background:var(--accent);
  color:white;
  padding:12px;
  border-radius:8px;
  text-align:center;
  font-weight:600;
  font-family:monospace;
}
.modal-buttons{
  display:flex;
  gap:10px;
  margin-top:16px;
}
.modal-buttons button{flex:1;}

.card{
  background:var(--card);
  border-radius:12px;
  padding:14px;
  margin-bottom:16px;
}

/* CUADROS DE LA 2¬™ P√ÅGINA */
.month-grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(260px,1fr));
  gap:12px;
}
.day-box{
  background:var(--accent);
  color:white;
  border-radius:12px;
  padding:12px;
}
body.dark .day-box{
  background:#4b5563;
}
.day-box h3{margin:0 0 6px 0;color:white;}
.section{margin-top:6px;border-top:1px solid #ffffff55;padding-top:6px;font-size:.9em;}
.section-title{font-weight:bold;margin-bottom:4px;}
.row{display:flex;justify-content:space-between;}
.today{outline:4px solid gold;}
</style>
</head>

<body>

<!-- PANTALLA DE ENTRADA -->
<div id="preScreen">
  <div class="preCard">
    <h2>Antes de entrar</h2>

    <label>¬øCu√°ntos a√±os tiene?</label>
    <input type="number" id="edad" placeholder="su edad">

    <label>¬øTiene problemas para ver?</label>
    <select id="vision">
      <option value="">Seleccione‚Ä¶</option>
      <option value="si">S√≠</option>
      <option value="no">No</option>
    </select>

    <button class="btn" onclick="entrar()">Entrar</button>
  </div>
</div>

<!-- TU P√ÅGINA -->
<div class="container">

  <div class="topbar">
    <h2>Programa de Predicaci√≥n</h2>
    <div class="topbar-buttons">
      <button class="btn" onclick="toggleFormatMenu()">üî§ Formato de letra</button>
      <button class="btn" onclick="reiniciarPagina()">üîÑ Reiniciar</button>
      <button class="btn" onclick="toggleTheme()">üåô modo oscuro/ ‚òÄÔ∏è modo claro</button>
    </div>
  </div>

  <!-- POPUP FORMATO DE LETRA -->
  <div id="formatPopup" class="format-popup">
    <div class="format-label">Tama√±o de letra</div>
    <input type="range" id="fontSlider" class="slider" min="0.8" max="1.6" step="0.1" value="1">
  </div>

  <!-- MODAL C√ìDIGOS DE REPORTE -->
  <div id="codigosModal" class="modal">
    <div class="modal-content">
      <h2>üìã C√≥digos de Reporte</h2>
      <p>Aqu√≠ est√°n los 24 c√≥digos generados. An√≥talos en un lugar seguro:</p>
      <div class="codigos-grid" id="codigosGrid"></div>
      <div class="modal-buttons">
        <button class="btn" onclick="cerrarCodigosModal()">Entendido</button>
        <button class="btn btn-success" onclick="copiarTodosLosCodigos()">üìã Copiar todos</button>
      </div>
    </div>
  </div>

  <!-- HOY -->
  <div id="todayBox" class="day-box today"></div>

  <!-- TODOS LOS D√çAS -->
  <div class="month-grid" id="grid"></div>

</div>

<script>
/* ===== PANTALLA PREVIA ===== */
function entrar(){
  const edad=document.getElementById("edad").value;
  const vision=document.getElementById("vision").value;

  if(!edad || !vision){
    alert("Responde las dos preguntas");
    return;
  }
  // Guardar datos en localStorage
  localStorage.setItem("userEdad", edad);
  localStorage.setItem("userVision", vision);
  
  // Aplicar estilos seg√∫n visi√≥n (si tiene problemas para ver ‚Üí letra grande siempre)
  if(vision==="si"){
    document.body.classList.add("large-text");
  }
  
  document.getElementById("preScreen").style.display="none";
}

/* ===== TU C√ìDIGO ORIGINAL ===== */
// Cargar datos guardados al iniciar
function cargarDatosGuardados(){
  const edadGuardada=localStorage.getItem("userEdad");
  const visionGuardada=localStorage.getItem("userVision");
  const fontSizeGuardada=localStorage.getItem("fontSize");
  
  if(edadGuardada && visionGuardada){
    // Si hay datos guardados, aplicar configuraci√≥n y ocultar pantalla previa
    if(visionGuardada==="si"){
      document.body.classList.add("large-text");
    }
    document.getElementById("preScreen").style.display="none";
  } else {
    // Si no hay datos, cargar los valores en los campos
    if(edadGuardada){
      document.getElementById("edad").value=edadGuardada;
    }
    if(visionGuardada){
      document.getElementById("vision").value=visionGuardada;
    }
  }
  
  // Cargar formato de letra guardado
  if(fontSizeGuardada){
    document.documentElement.style.fontSize=fontSizeGuardada+"em";
    document.getElementById("fontSlider").value=fontSizeGuardada;
  }
}

// Ejecutar al cargar la p√°gina
cargarDatosGuardados();

// 24 C√ìDIGOS FIJOS PARA REPORTES
const codigosReportes=[
  "BENJA.M11", "JOSUE.L11", "LUIS.T11", "MARIO.R11", "MARCO.C11", "LUIS.P11",
  "EDUARDO.P11", "EDMUNDO.J11", "NESTOR.U11", "JUAN.C.M11", "GUILLERMO.A11", "HECTOR.C11", "ROBERTO.A11", "DANILO.P11", "ARIEL.C11", "CARLOS.M11",
];


// NOMBRES DE MESES
const meses=["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"];
const mesActual=meses[new Date().getMonth()];

// NOMBRES DE D√çAS
const diasSemana=["domingo","lunes","martes","mi√©rcoles","jueves","viernes","s√°bado"];

// Funci√≥n para obtener el d√≠a de la semana de un d√≠a espec√≠fico
function obtenerDiaSemana(dia){
  const fecha=new Date(new Date().getFullYear(),new Date().getMonth(),dia);
  return diasSemana[fecha.getDay()];
}

const programa = {

1:{m:{h:"9:30",enc:"Reuni√≥n fin de semana",ter:"",car:""}},

2:{m:{h:"9:30",enc:"Familia Mamani",ter:"14",car:"Benjamin Manzano"},
   t:{h:"9:30",enc:"Hermana Soledad",ter:"12",car:"Josue Leal"}},

3:{m:{h:"10:00",enc:"Familia Pires",ter:"18",car:"Luis Troncoso"},
   t:{h:"10:00",enc:"Familia Guerrero",ter:"5",car:"Luis Troncoso"}},

4:{m:{h:"9:30",enc:"Familia Roco",ter:"4",car:"Mario Roco"}},

5:{m:{h:"9:30",enc:"Familia Aros",ter:"19",car:"Luis Troncoso"},
   t:{h:"18:15",enc:"Hermana Adriana",ter:"28 y 29",car:"Marco Carcamo"}},

6:{m:{h:"9:30",enc:"Hermana Soledad",ter:"10",car:"Luis Pi√±ones"},
   t:{h:"9:30",enc:"Familia Mamani",ter:"15",car:"Eduardo Poo"}},

7:{m:{h:"9:30",enc:"Arreglo por Grupo",ter:"",car:""}},

8:{m:{h:"11:50",enc:"Predicaci√≥n por Cartas",ter:"",car:""}},

9:{m:{h:"9:30",enc:"Familia Aros",ter:"25",car:"Benjamin Manzano"},
   t:{h:"9:30",enc:"Familia Guerrero",ter:"1",car:"Edmundo J."}},

10:{m:{h:"9:30",enc:"Familia Pires",ter:"17",car:"Luis Troncoso"},
    t:{h:"9:30",enc:"Familia Mamani",ter:"15",car:"Nestor Usquiano"}},

11:{m:{h:"9:30",enc:"Familia Roco",ter:"2",car:"Juan Carlos M."}},

12:{m:{h:"9:30",enc:"Hermana Soledad",ter:"12",car:"Guillermo Aliste"},
    t:{h:"18:15",enc:"Familia Pires",ter:"24",car:"Edmundo J."}},

13:{m:{h:"9:30",enc:"Familia Guerrero",ter:"5",car:"Luis Troncoso"},
    t:{h:"9:30",enc:"Familia Mamani",ter:"16",car:"Eduardo Poo"}},

14:{m:{h:"10:00",enc:"Arreglo por Grupo",ter:"",car:""}},

15:{m:{h:"9:30",enc:"Reuni√≥n fin de semana",ter:"",car:""}},

16:{m:{h:"9:30",enc:"Familia Pires",ter:"26",car:"Benjamin Manzano"},
    t:{h:"9:30",enc:"Hermana Soledad",ter:"10",car:"Edmundo J."}},

17:{m:{h:"9:30",enc:"Familia Pires",ter:"22",car:"Luis Pi√±ones"},
    t:{h:"9:30",enc:"Hermana Adriana",ter:"30 y 31",car:"Nestor Usquiano"}},

18:{m:{h:"9:30",enc:"Familia Mamani",ter:"14",car:"Mario Roco"}},

19:{m:{h:"9:30",enc:"Familia Pires",ter:"20",car:"Guillermo Aliste"},
    t:{h:"9:30",enc:"Familia Guerrero",ter:"7",car:"Marco Carcamo"}},

20:{m:{h:"9:30",enc:"Familia Roco",ter:"6",car:"Luis Troncoso"},
    t:{h:"18:15",enc:"Familia Roco",ter:"8",car:"Eduardo Poo"}},

21:{m:{h:"10:00",enc:"Arreglo por Grupo",ter:"",car:""}},

22:{m:{h:"9:30",enc:"Predicaci√≥n por Cartas",ter:"",car:""}},

23:{m:{h:"9:30",enc:"Familia Aros",ter:"19",car:"Benjamin Manzano"},
    t:{h:"9:30",enc:"Familia Mamani",ter:"13",car:"Josue Leal"}},

24:{m:{h:"9:30",enc:"Hermana Soledad",ter:"12",car:"Luis Troncoso"},
    t:{h:"18:15",enc:"Hermana Adriana",ter:"28 y 29",car:"Edmundo J."}},

25:{m:{h:"9:30",enc:"Familia Pires",ter:"27",car:"Mario Roco"}},

26:{m:{h:"9:30",enc:"Familia Guerrero",ter:"4",car:"Guillermo Aliste"},
    t:{h:"9:30",enc:"Familia Roco",ter:"3",car:"Nestor Usquiano"}},

27:{m:{h:"9:30",enc:"Familia Pires",ter:"20",car:"Hector Carcamo"}},

28:{m:{h:"9:30",enc:"Arreglo por Grupo",ter:"",car:""}}

};


const hoy = new Date().getDate();

// üîπ Tarjeta especial de HOY arriba
if(hoy <= 28){
  renderBox(document.getElementById("todayBox"), hoy, true);
}else{
  document.getElementById("todayBox").innerHTML =
  "<h3>Hoy no est√° dentro de los 28 d√≠as del programa</h3>";
}

// üîπ Todas las dem√°s tarjetas abajo
const grid = document.getElementById("grid");
grid.innerHTML="";

for(let d=1; d<=28; d++){
  if(d === hoy) continue; // no repetir el d√≠a de hoy abajo
  const box=document.createElement("div");
  box.className="day-box";
  renderBox(box,d,false);
  grid.appendChild(box);
}



function renderBox(box,day,isToday){
  const p=programa[day]||{};
  const dayNum=parseInt(day);
  let titulo="";
  
  if(isToday){
    titulo="‚≠ê HOY ("+obtenerDiaSemana(dayNum)+" "+dayNum+")";
  }

 else if(dayNum>=19){
    // D√≠as 19-31 muestran el d√≠a de la semana
    titulo=obtenerDiaSemana(dayNum)+" "+dayNum;
    // Capitalizar primera letra
    titulo=titulo.charAt(0).toUpperCase()+titulo.slice(1);
  } else {
    // D√≠as 1-18 muestran mes y n√∫mero
    titulo=mesActual+" "+dayNum;
  }
  
  let contenido=`
    <h3>${titulo}</h3>
    ${section("üåÖ Ma√±ana",p.m)}
    ${section("üåá Tarde",p.t)}
    <div class="report-actions">
      <input id="codigoInput-${day}" class="codigo-input" placeholder="C√≥digo" aria-label="C√≥digo del d√≠a ${day}">
      <button class="btn btn-success" onclick="abrirReporteInput(${day})">üì§ Enviar Reporte</button>
    </div>
  `;
  
  if(isToday && (p.m || p.t)){
    contenido+=`<button id="explicarHoyBtn" class="btn btn-warning full-width" onclick="explicarDiaDeHoy()">üé§ Explicar el d√≠a de hoy</button>`;
  }
  
  box.innerHTML=contenido;
}
function section(t,d){
  if(!d) return `<div class="section"><em>Sin predicaci√≥n</em></div>`;

  return `
  <div class="section">
    <div class="row"><strong>Hora</strong><span>${d.h || "-"}</span></div>
    <div class="row"><strong>Encuentro</strong><span>${d.enc || "-"}</span></div>
    <div class="row"><strong>Territorios</strong><span>${d.ter || "-"}</span></div>
    <div class="row"><strong>Encargado</strong><span>${d.car || "-"}</span></div>
  </div>`;
}

function toggleTheme(){document.body.classList.toggle("dark");}

function toggleFormatMenu(){
  const popup=document.getElementById("formatPopup");
  popup.classList.toggle("active");
}

document.getElementById("fontSlider").addEventListener("input",function(){
  const valor=this.value;
  document.documentElement.style.fontSize=valor+"em";
  localStorage.setItem("fontSize",valor);
});

function reiniciarPagina(){
  if(confirm("¬øEst√°s seguro? Se borrar√°n tu edad y respuesta sobre visi√≥n (pero se mantiene el formato de letra)")){
    localStorage.removeItem("userEdad");
    localStorage.removeItem("userVision");
    location.reload();
  }
}

function abrirReporteInput(dia){
  const input = document.getElementById(`codigoInput-${dia}`);
  const codigo = input ? input.value.trim() : '';
  if(!codigo){
    alert('Ingresa el c√≥digo en la casilla antes de enviar');
    if(input) input.focus();
    return;
  }
  const codigoUpper = codigo.toUpperCase();
  if(codigosReportes.includes(codigoUpper)){
    const params = new URLSearchParams({dia: dia, codigo: codigoUpper});
    window.location.href = "reporte.html?"+params.toString();
  } else {
    alert('‚ùå C√≥digo inv√°lido. Verifica e intenta de nuevo.');
    if(input) input.focus();
  }
}

function mostrarCodigosReporte(){
  const grid=document.getElementById("codigosGrid");
  grid.innerHTML=codigosReportes.map(cod=>`<div class="codigo-item">${cod}</div>`).join("");
  document.getElementById("codigosModal").classList.add("active");
}

function cerrarCodigosModal(){
  document.getElementById("codigosModal").classList.remove("active");
}

function copiarTodosLosCodigos(){
  const texto=codigosReportes.join("\n");
  navigator.clipboard.writeText(texto).then(()=>{
    alert("‚úÖ C√≥digos copiados al portapapeles");
  });
}

function explicarDiaDeHoy(){
  const p = programa[hoy] || {};
  let explicacion = "El d√≠a " + hoy + " de predicaci√≥n. ";

  if(p.m){
    explicacion += `Por la ma√±ana a las ${p.m.h || "sin hora definida"}, el encuentro es en ${p.m.enc || "lugar no definido"}. `;
    
    if(p.m.car){
      explicacion += `Encargado: ${p.m.car}. `;
    }

    if(p.m.ter){
      explicacion += `Territorio ${p.m.ter}. `;
    }
  }

  if(p.t){
    explicacion += `Por la tarde a las ${p.t.h || "sin hora definida"}, el encuentro es en ${p.t.enc || "lugar no definido"}. `;
    
    if(p.t.car){
      explicacion += `Encargado: ${p.t.car}. `;
    }

    if(p.t.ter){
      explicacion += `Se trabajara en el territorio ${p.t.ter}. `;
    }
  }

  if(!p.m && !p.t){
    explicacion += "No hay predicaci√≥n programada para hoy.";
  }

  // Voz
  if('speechSynthesis' in window){
    window.speechSynthesis.cancel();
    const utterance = new SpeechSynthesisUtterance(explicacion);
    utterance.lang = 'es-ES';
    utterance.rate = 0.9;
    utterance.pitch = 1;
    window.speechSynthesis.speak(utterance);
  } else {
    alert("Tu navegador no soporta s√≠ntesis de voz.\n\n" + explicacion);
  }
}

</script>

</body>
</html>
